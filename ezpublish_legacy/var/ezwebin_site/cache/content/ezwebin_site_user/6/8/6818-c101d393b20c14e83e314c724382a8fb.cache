a:10:{s:7:"content";s:21458:"
<div class="class-blog extrainfo">
    <div class="columns-blog float-break">
        <div class="main-column-position">
            <div class="main-column float-break">
                <div class="border-box">
                <div class="border-tl"><div class="border-tr"><div class="border-tc"></div></div></div>
                <div class="border-ml"><div class="border-mr"><div class="border-mc float-break">

                        <div class="content-view-full">
                            <div class="class-blog-post float-break">

                                <div class="attribute-header">
                                    <h1>Weather from the Norwegians, sunset and sunrise</h1>
                                </div>

                                <div class="attribute-byline">
				    <div><a href="http://derickrethans.nl/suninfo.html">Read Original Item</a></div><br />
                                </div>

                                <div class="attribute-byline">
                                    <p class="date">12/21/2012 05:12 am</p>
                                    <p class="author"></p>
				                                    </div>

				

				<div class="attribute-body float-break">
				      <div class="article">
  <div class="body">
    <div class="articleListItem">
      <h1><a name="weather_from_the_norwegians_sunset_and_sunrise"/>Weather from the Norwegians, sunset and sunrise</h1>
      <dl class="head"/>
      <div class="articleMetaData">
        <div class="location"> London, UK</div>
        <div class="date">Friday, December 21st 2012, 11:12 GMT</div>
      </div>
      <img src="http://derickrethans.nl/images/content/pi-sun.png" alt="Weather widget" class="right"/>
      <p>I have recently acquired a <a href="http://www.raspberrypi.org/">Raspberry PI</a> and as a hacking project I am using it as status screen in the living room. As part of this, it has a weather widget.</p>
      <p>I use the weather data from <a href="http://yr.no">http://yr.no</a> ("the Norwegians") as they provide <a href="http://om.yr.no/verdata/free-weather-data/">free</a> weather data for the whole world. For each location, there is a nice <a href="http://www.yr.no/place/United_Kingdom/England/London/forecast_hour_by_hour.xml">XML file</a> with the weather forecast.</p>
      <p>The XML file has a forecast for several periods. See for example the first upcoming one:</p>
      <pre><?xml version="1.0" encoding="utf-8"?>
<weatherdata>
  …
  <forecast>
        <tabular>
          <time from="2012-12-21T12:00:00" to="2012-12-21T13:00:00">
                <symbol number="1" name="Fair" var="01d" />
                <precipitation value="0" />
                <windDirection deg="253.3" code="WSW" name="West-southwest" />
                <windSpeed mps="4.8" name="Gentle breeze" />
                <temperature unit="celsius" value="7" />
                <pressure unit="hPa" value="1009.8" />
          </time>

</pre>
      <p>This shows among others, the period (December 21st, 12:00 to 13:00), the symbol to use (<code>number="1"</code>), the expected precipitation and temperature. There is a description of what the <a href="http://om.yr.no/forklaring/symbol/">symbols</a> mean. The page is in Norwegian, but that's all right, as I can actually read that.</p>
      <p>For most of the symbols there is both a day and a night variant of the symbol. And in some cases, there is also a "mørketid" variant - the period in which the sun never comes over the horizon.</p>
      <p>In each XML file, the coordinates of the location for which the forecast is are also present:</p>
      <pre><?xml version="1.0" encoding="utf-8"?>
<weatherdata>
  <location>
        <name>London</name>
        <type>Capital</type>
        <country>United Kingdom</country>
        <timezone id="Europe/London" utcoffsetMinutes="0" />
        <location altitude="21" latitude="51.50853" longitude="-0.12574" geobase="geonames" geobaseid="2643743" />
  </location>

</pre>
      <p>The location information comes from <a href="http://geonames.org">http://geonames.org</a>, which handily also includes the <a href="http://en.wikipedia.org/wiki/IANA_time_zone_database#Names_of_time_zones">Olson timezone ID</a> for the location. The <em>timezone ID</em> combined with the <em>time</em>, the <em>latitude</em> and the <em>longitude</em> are enough to calculate sunrise and sunset times with PHP's <a href="http://php.net/manual/en/function.date-sun-info.php">date_sun_info()</a> function.</p>
      <p>For example, to find out the sunset and sunrise for today in London (Europe/London, 51.50833°N, 0.12574°W):</p>
      <pre><?php
$result = date_sun_info( time(), 51.50853, -0.12574 );
print_r( $result );
?>

</pre>
      <p>This returns the following array:</p>
      <pre>Array
(
        [sunrise] => 1356077046
        [sunset] => 1356105238
        [transit] => 1356091142
        [civil_twilight_begin] => 1356074637
        [civil_twilight_end] => 1356107647
        [nautical_twilight_begin] => 1356072046
        [nautical_twilight_end] => 1356110239
        [astronomical_twilight_begin] => 1356069597
        [astronomical_twilight_end] => 1356112687
)

</pre>
      <p>Each value is a <a href="http://en.wikipedia.org/wiki/Unix_timestamp">Unix timestamp</a>. To display when the Sun rises and sets:</p>
      <pre><?php
$result = date_sun_info( time(), 51.50853, -0.12574 );
echo 'Sunrise: ', date( 'H:i', $result['sunrise'] ), ", ";
echo 'Sunset: ', date( 'H:i', $result['sunset'] ), "\n";
?>

</pre>
      <p>Which shows (for today): <code>Sunrise: 08:04, Sunset: 15:53</code>. The <em>transit</em> value is the time when the Sun is at its highest point, and the different twilight_begin/twilight_end values represent different start and end times of the three different forms of <a href="http://en.wikipedia.org/wiki/Twilight">twilight</a>. From the above information, it is also trivial to calculate the length of day: <code>echo $result['sunset'] -
$result['sunrise']);</code> (or today in London: <em>28192 seconds</em>, which is <em>7h49m52s</em>).</p>
      <p>Near the summer and winter <a href="http://en.wikipedia.org/wiki/Solstice">solstices</a> there are regions on Earth where the Sun never rises (the afore mentioned "mørketid") or when the Sun never sets. If we take for example Kirkenes in Northern Norway (69.72°N, 30.04°E), we can calculate all the different values with:</p>
      <pre><?php
date_default_timezone_set( 'Europe/Oslo' );
$result = date_sun_info( time(), 69.72, 30.04 );
foreach ( $result as $key => $value )
{
        if ( gettype( $value ) == 'boolean' ) {
                echo $key, ': always ', $value ? 'above' : 'below', "\n";
        } else {
                echo $key, ': ', date( 'H:i', $value ), "\n";
        }
}
?>

</pre>
      <p>Which shows:</p>
      <pre>sunrise: always below
sunset: always below
transit: 10:58
civil_twilight_begin: 08:48
civil_twilight_end: 13:07
nautical_twilight_begin: 07:03
nautical_twilight_end: 14:53
astronomical_twilight_begin: 05:44
astronomical_twilight_end: 16:11

</pre>
      <p>Indicating that the Sun never rises. During summer (July 22nd, 13:45 CEST), it shows for Kirkenes:</p>
      <pre>sunrise: always above
sunset: always above
transit: 12:06
civil_twilight_begin: always above
civil_twilight_end: always above
nautical_twilight_begin: always above
nautical_twilight_end: always above
astronomical_twilight_begin: always above
astronomical_twilight_end: always above

</pre>
      <p>Which indicates that the Sun is always above the horizon.</p>
      <p>It is important to use the correct timezone in your script, otherwise you get weird results:</p>
      <pre><?php
// Timezone for London, location for Los Angeles
date_default_timezone_set( 'Europe/London' );
$result = date_sun_info( time(), 34.0522, -118.2437 );
echo 'Sunrise: ', date( 'H:i', $result['sunrise'] ), ", ";
echo 'Transit: ', date( 'H:i', $result['transit'] ), ", ";
echo 'Sunset: ', date( 'H:i', $result['sunset'] ), "\n";
?>

</pre>
      <p>Which then shows:</p>
      <pre>Sunrise: 14:55, Transit: 19:51, Sunset: 00:48

</pre>
      <p>Which is clearly incorrect.</p>
      <p>Now we have figured out whether it's day, night or "mørketid" we can show the correct symbol. With "Partly Cloudy" (symbol <code>$nr = 5</code>) we select the symbol as follows:</p>
      <pre>if ( $result['sunrise'] === false || $result['sunset'] === false )
{
        $symbol = sprintf( "%02dm", $nr );
}
else if ( time() > $result['sunrise'] && time() < $result['sunset'] ) )
{
        $symbol = sprintf( "%02dd", $nr );
}
else
{
        $symbol = sprintf( "%02dn", $nr );
}

</pre>
      <img src="http://derickrethans.nl/images/content/weather-symbols.png" alt="Yr's weather symbols" class="center"/>
      <p>
        <strong>Some last notes</strong>
      </p>
      <p>If I would have paid more attention, I would have seen in the XML file:</p>
      <pre><sun rise="2012-12-21T08:03:58" set="2012-12-21T15:53:39"/>

</pre>
      <p>which means I wouldn't have had to calculate the sunrise and sunset.</p>
      <p>I would also have seen the <code>var="mf/01n.26"</code> part of:</p>
      <pre><time from="2012-12-21T16:00:00" to="2012-12-21T17:00:00">
  <symbol number="1" name="Fair" var="mf/01n.26" />

</pre>
      <p>which means I wouldn't have to do the ugly trick to create the correct symbol in the first place… Of course, this article wouldn't have been as nearly as interesting then.</p>
      <p>
        <strong>Happy Southern Solstice!</strong>
      </p>
      <div class="credits">
        <p> Weather forecast from yr.no, delivered by the Norwegian Meteorological Institute and the NRK (Weather forecast) — http://www.yr.no/place/United_Kingdom/England/London/</p>
      </div>
      <div class="credits">
        <p> Weather symbols from yr.no (Images) — http://om.yr.no/forklaring/symbol/</p>
      </div>
      <div class="flattr">
        <a class="FlattrButton" rev="flattr;button:compact;" style="display: none" href="http://derickrethans.nl"/>
        <noscript>
          <a href="http://flattr.com/thing/429095/Derick-Rethans-website">
            <img src="http://api.flattr.com/button/flattr-badge-large.png" alt="Flattr this" title="Flattr this"/>
          </a>
        </noscript>
      </div>
      
    </div>
  </div>
</div>

				</div>

                                
                                <div class="attribute-byline">
				    <div><a href="http://derickrethans.nl/suninfo.html">Read Original Item</a></div>
                                </div>

                                                            </div>
                        </div>

                </div></div></div>
                <div class="border-bl"><div class="border-br"><div class="border-bc"></div></div></div>
                </div>
            </div>
        </div>

        <div class="extrainfo-column-position">
            <div class="extrainfo-column">
                <div class="border-box">
                <div class="border-tl"><div class="border-tr"><div class="border-tc"></div></div></div>
                <div class="border-ml"><div class="border-mr"><div class="border-mc float-break">
                                                <div class="attribute-tag-cloud">
                        <p>
                            
                        </p>
                        </div>

                        <div class="attribute-description">
                            
                        </div>

                        <div class="attribute-tags">
                            <h1>Tags</h1>
                            <ul>
                                                        </ul>
                        </div>

                        <div class="attribute-archive">
                            <h1>Archive</h1>
                            <ul>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/8/(year)/2014" title="">August 2014</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/7/(year)/2014" title="">July 2014</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/6/(year)/2014" title="">June 2014</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/5/(year)/2014" title="">May 2014</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/4/(year)/2014" title="">April 2014</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/3/(year)/2014" title="">March 2014</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/2/(year)/2014" title="">February 2014</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/1/(year)/2014" title="">January 2014</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/12/(year)/2013" title="">December 2013</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/11/(year)/2013" title="">November 2013</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/10/(year)/2013" title="">October 2013</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/9/(year)/2013" title="">September 2013</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/7/(year)/2013" title="">July 2013</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/6/(year)/2013" title="">June 2013</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/4/(year)/2013" title="">April 2013</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/3/(year)/2013" title="">March 2013</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/1/(year)/2013" title="">January 2013</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/12/(year)/2012" title="">December 2012</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/11/(year)/2012" title="">November 2012</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/10/(year)/2012" title="">October 2012</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/8/(year)/2012" title="">August 2012</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/7/(year)/2012" title="">July 2012</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/6/(year)/2012" title="">June 2012</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/5/(year)/2012" title="">May 2012</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/4/(year)/2012" title="">April 2012</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/3/(year)/2012" title="">March 2012</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/2/(year)/2012" title="">February 2012</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/12/(year)/2011" title="">December 2011</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/11/(year)/2011" title="">November 2011</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/9/(year)/2011" title="">September 2011</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/8/(year)/2011" title="">August 2011</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/7/(year)/2011" title="">July 2011</a></li>
                                                            <li><a href="/Mirror/Derick-Rethans/(month)/6/(year)/2011" title="">June 2011</a></li>
                                                        </ul>
                        </div>

                        <!--START: CAL NAV -->
                                                                                                                                                                                                                                                                                                                                        
<div class="calendar">
<div class="calendar-tl"><div class="calendar-tr"><div class="calendar-bl"><div class="calendar-br">
<div class="content">

<div class="month">
<div class="previous">
<p><a href="/Mirror/Derick-Rethans/(month)/7/(year)/2014" title="Previous month">&#8249;&#8249;<span class="hide"> Previous month</span></a></p>
</div>
<div class="next">
<p><a href="/Mirror/Derick-Rethans/(month)/9/(year)/2014" title="Next month"><span class="hide">Next month </span>&#8250;&#8250;</a></p>
</div>
<h2>August&nbsp;2014</h2>
</div>

<div class="table">
<table cellspacing="0" border="0" summary="Calendar">
<tr class="top">
    <th class="left">Mon</th>
    <th>Tue</th>
    <th>Wed</th>
    <th>Thu</th>
    <th>Fri</th>
    <th>Sat</th>
    <th class="right">Sun</th>
</tr>                <tr class="">
                                            <td class="left">&nbsp;</td>
                                <td>&nbsp;</td>
                                <td>&nbsp;</td>
                                <td>&nbsp;</td>
                            <td class=" ">
            1
        </td>
                            <td class=" ">
            2
        </td>
                                        <td class="  right">
            3
        </td>
                </tr>
                        <tr class="">
                    <td class="  left">
            4
        </td>
                            <td class=" ">
            5
        </td>
                            <td class=" ">
            6
        </td>
                            <td class=" ">
            7
        </td>
                            <td class=" ">
            <em><a href="/Mirror/Derick-Rethans/(day)/8/(month)/8/(year)/2014">8</a></em>
        </td>
                            <td class=" ">
            9
        </td>
                                        <td class="  right">
            10
        </td>
                </tr>
                        <tr class="">
                    <td class="  left">
            11
        </td>
                            <td class=" ">
            12
        </td>
                            <td class=" ">
            13
        </td>
                            <td class=" ">
            14
        </td>
                            <td class=" ">
            15
        </td>
                            <td class=" ">
            16
        </td>
                                        <td class="  right">
            17
        </td>
                </tr>
                        <tr class="">
                    <td class="  left">
            18
        </td>
                            <td class=" ">
            19
        </td>
                            <td class=" ">
            20
        </td>
                            <td class=" ">
            <em><a href="/Mirror/Derick-Rethans/(day)/21/(month)/8/(year)/2014">21</a></em>
        </td>
                            <td class=" ">
            22
        </td>
                            <td class=" ">
            23
        </td>
                                        <td class="  right">
            24
        </td>
                </tr>
                        <tr class="bottom">
                    <td class="  left">
            25
        </td>
                            <td class=" ">
            26
        </td>
                            <td class="currentselected today">
            <em><a href="/Mirror/Derick-Rethans/(day)/27/(month)/8/(year)/2014">27</a></em>
        </td>
                            <td class=" ">
            28
        </td>
                            <td class=" ">
            29
        </td>
                            <td class=" ">
            30
        </td>
                                        <td class="  right">
            31
        </td>
                </tr>
        </table>
</div>

</div>
</div></div></div></div>
</div>

<!-- END: CAL NAV -->                </div></div></div>
                <div class="border-bl"><div class="border-br"><div class="border-bc"></div></div></div>
                </div>
            </div>
        </div>
    </div>
</div>";s:15:"view_parameters";a:5:{s:6:"offset";b:0;s:4:"year";b:0;s:5:"month";b:0;s:3:"day";b:0;s:10:"namefilter";b:0;}s:4:"path";a:4:{i:0;a:4:{s:4:"text";s:12:"eZ Ecosystem";s:3:"url";s:20:"/content/view/full/2";s:9:"url_alias";s:0:"";s:7:"node_id";s:1:"2";}i:1;a:4:{s:4:"text";s:6:"Mirror";s:3:"url";s:22:"/content/view/full/216";s:9:"url_alias";s:6:"Mirror";s:7:"node_id";s:3:"216";}i:2;a:4:{s:4:"text";s:14:"Derick Rethans";s:3:"url";s:23:"/content/view/full/1726";s:9:"url_alias";s:21:"Mirror/Derick-Rethans";s:7:"node_id";s:4:"1726";}i:3;a:4:{s:4:"text";s:47:"Weather from the Norwegians, sunset and sunrise";s:3:"url";b:0;s:9:"url_alias";b:0;s:7:"node_id";s:4:"6818";}}s:10:"title_path";a:4:{i:0;a:4:{s:4:"text";s:12:"eZ Ecosystem";s:3:"url";s:20:"/content/view/full/2";s:9:"url_alias";s:0:"";s:7:"node_id";s:1:"2";}i:1;a:4:{s:4:"text";s:6:"Mirror";s:3:"url";s:22:"/content/view/full/216";s:9:"url_alias";s:6:"Mirror";s:7:"node_id";s:3:"216";}i:2;a:4:{s:4:"text";s:14:"Derick Rethans";s:3:"url";s:23:"/content/view/full/1726";s:9:"url_alias";s:21:"Mirror/Derick-Rethans";s:7:"node_id";s:4:"1726";}i:3;a:3:{s:4:"text";s:47:"Weather from the Norwegians, sunset and sunrise";s:3:"url";b:0;s:9:"url_alias";b:0;}}s:10:"section_id";s:1:"1";s:7:"node_id";s:4:"6818";s:15:"navigation_part";s:23:"ezcontentnavigationpart";s:12:"content_info";a:24:{s:9:"object_id";s:4:"6819";s:7:"node_id";s:4:"6818";s:14:"parent_node_id";s:4:"1726";s:8:"class_id";s:2:"20";s:16:"class_identifier";s:9:"blog_post";s:9:"remote_id";s:45:"RSSImport_26_5a459bce860e8072038202638b99e9b5";s:14:"node_remote_id";s:32:"2bdd726525cb48605875b6c431719310";s:6:"offset";b:0;s:8:"viewmode";s:4:"full";s:26:"navigation_part_identifier";s:23:"ezcontentnavigationpart";s:10:"node_depth";s:1:"4";s:9:"url_alias";s:68:"Mirror/Derick-Rethans/Weather-from-the-Norwegians-sunset-and-sunrise";s:16:"current_language";s:6:"eng-US";s:13:"language_mask";s:1:"2";s:12:"main_node_id";s:4:"6818";s:19:"main_node_url_alias";b:0;s:19:"persistent_variable";a:2:{s:9:"left_menu";b:0;s:10:"extra_menu";b:0;}s:11:"class_group";b:0;s:5:"state";a:1:{i:2;s:1:"1";}s:16:"state_identifier";a:1:{i:0;s:18:"ez_lock/not_locked";}s:15:"parent_class_id";s:2:"19";s:23:"parent_class_identifier";s:4:"blog";s:21:"parent_node_remote_id";s:32:"91895b5e697408d3dc46d96fc84528e1";s:23:"parent_object_remote_id";s:32:"ef986f18ea990204d5c4a5afc1984cd0";}s:13:"template_list";a:3:{i:0;s:64:"extension/ezecosystem/design/eze/templates/tagcloud/tagcloud.tpl";i:1;s:61:"design/standard/templates/content/datatype/view/ezxmltext.tpl";i:2;s:66:"extension/ezwebin/design/ezwebin/templates/parts/blog/calendar.tpl";}s:9:"cache_ttl";i:-1;}