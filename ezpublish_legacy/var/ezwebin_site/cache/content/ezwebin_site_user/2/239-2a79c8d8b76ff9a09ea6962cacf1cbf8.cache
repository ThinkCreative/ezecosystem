a:10:{s:7:"content";s:14511:"
<div class="class-blog extrainfo">
    <div class="columns-blog float-break">
        <div class="main-column-position">
            <div class="main-column float-break">
                <div class="border-box">
                <div class="border-tl"><div class="border-tr"><div class="border-tc"></div></div></div>
                <div class="border-ml"><div class="border-mr"><div class="border-mc float-break">
            
                                            
<div class="content-view-line">
    <div class="class-blog-post float-break">

    <div class="attribute-header">
        <h1><a href="/Mirror/Planet-eZ-Publish.fr">Planet eZ Publish.fr</a></h1>
     </div>
    <div class="attribute-header">
        <h2>> <a href="http://damien.pobel.fr/post/ez-publish-twig-pagelayout-legacy-module" title="Twig pagelayout pour les modules legacy dans eZ Publish 5">Twig pagelayout pour les modules legacy dans eZ Publish 5</a></h2>
     </div>

    <div class="attribute-byline">
	    </div>

    

    <div class="attribute-body float-break">
      <div><p>(<a href="http://share.ez.no/blogs/damien-pobel/twig-pagelayout-for-legacy-modules-in-ez-publish-5">English version available on share.ez.no</a>)</p>
<p>Je suis en train de mettre à jour <a href="http://www.planet-ezpublish.fr">le Planète eZ Publish.fr</a> à la dernière version d'eZ Publish 5. J'en profite pour passer en revue les problèmes ou les fonctionnalités manquantes que j'avais recontrés lors de <a href="http://damien.pobel.fr/post/planet-ez-publish-fr-mis-sur-orbite-par-ez-publish-5">la mise en place de la version avec eZ Publish 5 en décembre dernier</a>. <a href="https://github.com/dpobel/planet-ezpublish.fr/issues/20">L'un de ces problèmes</a> concernait les différences entre les pages générées par les modules legacy (<a href="http://www.planet-ezpublish.fr/ezinfo/about">ezinfo/about</a>, planet/search, ...) et le reste du site. En effet, en 5.0, <a href="https://jira.ez.no/browse/EZP-20576">il n'était pas possible d'utiliser un pagelayout Twig avec un module legacy</a>, et donc le résultat de ces modules étaient toujours injectés dans le bon vieux <code>pagealyout.tpl</code>. À partir des n <a href="http://share.ez.no/blogs/community-project-board/ez-publish-community-project-2013.4-report">2013.4</a> et 5.1, il est maintenant possible d'utiliser un pagelayout Twig avec les modules legacy. Il s'agit d'une fonctionnalité intéressante dans l'optique d'une mise à jour progressive vers la nouvelle stack, mais certains éléments autour de cette fonctionnalités sont intéressants.</p>
<p>Pour commencer, la version initiale a été ajoutée par <a href="http://partialcontent.com/">Joe Kepley</a> <em>via</em> <a href="https://github.com/ezsystems/ezpublish-kernel/pull/264">une pull request</a>. Il mérite un grand bravo pour ça :-)</p>
<p>Ensuite, en travaillant <a href="https://jira.ez.no/browse/EZP-20518">sur une amélioration</a>, j'ai ajouté la possibilité <a href="https://github.com/ezsystems/ezpublish-kernel/pull/277">de définir ce pagelayout par siteaccess ou groupe de siteaccess</a>. Il n'y a pas <a href="http://symfony.com/fr/doc/current/cookbook/bundles/extension.html">de configuration sémantique</a>, donc pour configurer le pagelayout à utiliser avec les modules legacy, il faut écrire la configuration suivante dans <code>ezpublish.yml</code> :</p>
<pre>
<code class="lang-yml">parameters:
  ezpublish_legacy.planete.module_default_layout: PlanetBundle::pagelayout.html.twig</code></pre>
<p>Dans cet exemple, <code>planete</code> est le nom du siteaccess et la valeur est évidemment le chemin vers le template.</p>
<p>Enfin, avec quelques changements, le même pagelayout peut être utilisé pour les modules legacy comme pour le reste du site. Le principal changement et potentiellement le seul à apporter concerne le block <code>content</code> pour qu'il tienne compte de l'éxécution d'un module legacy. Une simple condition sur la variable <code>module_result</code> permet de détecter le contexte :</p>
<pre>
<code class="lang-django">
<span class="tag"><<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"fr-FR"</span>></code>
<span class="comment"><!-- ... --></span>

<span class="tag"><<span class="title">body</span>>
<span class="template_tag">{% <span class="keyword">block</span> content %}</span>
    <span class="template_tag">{% <span class="keyword">if</span> module_result %}</span>
        <span class="template_comment">{# we are in a legacy rendered module #}</span>
        <span class="variable">{{ module_result.content<span class="filter">|raw</span> }}</span>
    <span class="template_tag">{% <span class="keyword">endif</span> %}</span>
<span class="template_tag">{% <span class="keyword">endblock</span> %}</span>
<span class="tag"></<span class="title">body</span>>
<span class="tag"></<span class="title">html</span>></pre>
<p>Rien de compliqué, non ? Il s'agit là d'un des nombreux ponts entre eZ Publish legacy et la nouvelle stack eZ Publish 5. Vous voulez en apprendre plus ? Si j'étais vous, je m'inscrirais à la prochaine <a href="http://ezuncon.ez.no/">eZ UnConference #2</a>. Sans conteste, le moyen le plus rapide de tout apprendre ou presque sur eZ Publish 5!</p></div>
    </div>

    <div class="attribute-url">
	<span>05/01/2013 05:59 am</span> &nbsp; <a href="http://www.planet-ezpublish.fr">www.planet-ezpublish.fr</a> &nbsp; <a href="/Mirror/Planet-eZ-Publish.fr/Twig-pagelayout-pour-les-modules-legacy-dans-eZ-Publish-5">View mirror of item</a> &nbsp; <a href="http://damien.pobel.fr/post/ez-publish-twig-pagelayout-legacy-module">View item</a>
    </div>

        

    </div>
</div>                        
                  

 

                </div></div></div>
                <div class="border-bl"><div class="border-br"><div class="border-bc"></div></div></div>
                </div>
            </div>
        </div>

        <div class="extrainfo-column-position">
            <div class="extrainfo-column">
                <div class="border-box">
                <div class="border-tl"><div class="border-tr"><div class="border-tc"></div></div></div>
                <div class="border-ml"><div class="border-mr"><div class="border-mc float-break">
                                                <div class="attribute-tag-cloud">
                        <p>
                            
                        </p>
                        </div>

                        <div class="attribute-description">
                            
                        </div>

                        <div class="attribute-tags">
                            <h1>Tags</h1>
                            <ul>
                                                        </ul>
                        </div>

                        <div class="attribute-archive">
                            <h1>Archive</h1>
                            <ul>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/7/(year)/2014" title="">July 2014</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/3/(year)/2014" title="">March 2014</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/2/(year)/2014" title="">February 2014</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/12/(year)/2013" title="">December 2013</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/11/(year)/2013" title="">November 2013</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/10/(year)/2013" title="">October 2013</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/9/(year)/2013" title="">September 2013</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/6/(year)/2013" title="">June 2013</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/5/(year)/2013" title="">May 2013</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/4/(year)/2013" title="">April 2013</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/1/(year)/2013" title="">January 2013</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/12/(year)/2012" title="">December 2012</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/10/(year)/2012" title="">October 2012</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/9/(year)/2012" title="">September 2012</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/8/(year)/2012" title="">August 2012</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/7/(year)/2012" title="">July 2012</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/6/(year)/2012" title="">June 2012</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/5/(year)/2012" title="">May 2012</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/4/(year)/2012" title="">April 2012</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/3/(year)/2012" title="">March 2012</a></li>
                                                            <li><a href="/Mirror/Planet-eZ-Publish.fr/(month)/2/(year)/2012" title="">February 2012</a></li>
                                                        </ul>
                        </div>

                        <!--START: CAL NAV -->
                                                                                                    
<div class="calendar">
<div class="calendar-tl"><div class="calendar-tr"><div class="calendar-bl"><div class="calendar-br">
<div class="content">

<div class="month">
<div class="previous">
<p><a href="/Mirror/Planet-eZ-Publish.fr/(month)/4/(year)/2013" title="Previous month">&#8249;&#8249;<span class="hide"> Previous month</span></a></p>
</div>
<div class="next">
<p><a href="/Mirror/Planet-eZ-Publish.fr/(month)/6/(year)/2013" title="Next month"><span class="hide">Next month </span>&#8250;&#8250;</a></p>
</div>
<h2>May&nbsp;2013</h2>
</div>

<div class="table">
<table cellspacing="0" border="0" summary="Calendar">
<tr class="top">
    <th class="left">Mon</th>
    <th>Tue</th>
    <th>Wed</th>
    <th>Thu</th>
    <th>Fri</th>
    <th>Sat</th>
    <th class="right">Sun</th>
</tr>                <tr class="">
                                            <td class="left">&nbsp;</td>
                                <td>&nbsp;</td>
                            <td class="currentselected ">
            <em><a href="/Mirror/Planet-eZ-Publish.fr/(day)/1/(month)/5/(year)/2013">1</a></em>
        </td>
                            <td class=" ">
            2
        </td>
                            <td class=" ">
            3
        </td>
                            <td class=" ">
            4
        </td>
                                        <td class="  right">
            5
        </td>
                </tr>
                        <tr class="">
                    <td class="  left">
            6
        </td>
                            <td class=" ">
            7
        </td>
                            <td class=" ">
            8
        </td>
                            <td class=" ">
            9
        </td>
                            <td class=" ">
            10
        </td>
                            <td class=" ">
            11
        </td>
                                        <td class="  right">
            12
        </td>
                </tr>
                        <tr class="">
                    <td class="  left">
            13
        </td>
                            <td class=" ">
            14
        </td>
                            <td class=" ">
            15
        </td>
                            <td class=" ">
            16
        </td>
                            <td class=" ">
            17
        </td>
                            <td class=" ">
            18
        </td>
                                        <td class="  right">
            19
        </td>
                </tr>
                        <tr class="">
                    <td class="  left">
            20
        </td>
                            <td class=" ">
            21
        </td>
                            <td class=" ">
            22
        </td>
                            <td class=" ">
            23
        </td>
                            <td class=" ">
            24
        </td>
                            <td class=" ">
            25
        </td>
                                        <td class="  right">
            26
        </td>
                </tr>
                        <tr class="bottom">
                    <td class="  left">
            27
        </td>
                            <td class=" ">
            28
        </td>
                            <td class=" ">
            29
        </td>
                            <td class=" ">
            30
        </td>
                            <td class=" ">
            31
        </td>
                                <td>&nbsp;</td>
                                <td class="right">&nbsp;</td>
                                    </tr>
        </table>
</div>

</div>
</div></div></div></div>
</div>

<!-- END: CAL NAV -->                </div></div></div>
                <div class="border-bl"><div class="border-br"><div class="border-bc"></div></div></div>
                </div>
            </div>
        </div>
    </div>
</div>";s:15:"view_parameters";a:5:{s:6:"offset";b:0;s:4:"year";s:4:"2013";s:5:"month";s:1:"5";s:3:"day";b:0;s:10:"namefilter";b:0;}s:4:"path";a:3:{i:0;a:4:{s:4:"text";s:12:"eZ Ecosystem";s:3:"url";s:20:"/content/view/full/2";s:9:"url_alias";s:0:"";s:7:"node_id";s:1:"2";}i:1;a:4:{s:4:"text";s:6:"Mirror";s:3:"url";s:22:"/content/view/full/216";s:9:"url_alias";s:6:"Mirror";s:7:"node_id";s:3:"216";}i:2;a:4:{s:4:"text";s:20:"Planet eZ Publish.fr";s:3:"url";b:0;s:9:"url_alias";b:0;s:7:"node_id";s:3:"239";}}s:10:"title_path";a:3:{i:0;a:4:{s:4:"text";s:12:"eZ Ecosystem";s:3:"url";s:20:"/content/view/full/2";s:9:"url_alias";s:0:"";s:7:"node_id";s:1:"2";}i:1;a:4:{s:4:"text";s:6:"Mirror";s:3:"url";s:22:"/content/view/full/216";s:9:"url_alias";s:6:"Mirror";s:7:"node_id";s:3:"216";}i:2;a:3:{s:4:"text";s:20:"Planet eZ Publish.fr";s:3:"url";b:0;s:9:"url_alias";b:0;}}s:10:"section_id";s:1:"1";s:7:"node_id";s:3:"239";s:15:"navigation_part";s:23:"ezcontentnavigationpart";s:12:"content_info";a:24:{s:9:"object_id";s:3:"237";s:7:"node_id";s:3:"239";s:14:"parent_node_id";s:3:"216";s:8:"class_id";s:2:"19";s:16:"class_identifier";s:4:"blog";s:9:"remote_id";s:32:"151890fdce8e55ae15819afeafc7c857";s:14:"node_remote_id";s:32:"7f415b1fa83ea305e9dda229c01e0140";s:6:"offset";b:0;s:8:"viewmode";s:4:"full";s:26:"navigation_part_identifier";s:23:"ezcontentnavigationpart";s:10:"node_depth";s:1:"3";s:9:"url_alias";s:27:"Mirror/Planet-eZ-Publish.fr";s:16:"current_language";s:6:"eng-US";s:13:"language_mask";s:1:"2";s:12:"main_node_id";s:3:"239";s:19:"main_node_url_alias";b:0;s:19:"persistent_variable";a:2:{s:9:"left_menu";b:0;s:10:"extra_menu";b:0;}s:11:"class_group";b:0;s:5:"state";a:1:{i:2;s:1:"1";}s:16:"state_identifier";a:1:{i:0;s:18:"ez_lock/not_locked";}s:15:"parent_class_id";s:1:"1";s:23:"parent_class_identifier";s:6:"folder";s:21:"parent_node_remote_id";s:32:"418ada46ecd2d42b7744e9cee6c51085";s:23:"parent_object_remote_id";s:32:"5b6a5a0179108fb40b786874ab09d743";}s:13:"template_list";a:3:{i:0;s:64:"extension/ezecosystem/design/eze/templates/tagcloud/tagcloud.tpl";i:1;s:61:"design/standard/templates/content/datatype/view/ezxmltext.tpl";i:2;s:66:"extension/ezwebin/design/ezwebin/templates/parts/blog/calendar.tpl";}s:9:"cache_ttl";i:-1;}